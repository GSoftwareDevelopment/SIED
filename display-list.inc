{$I 'asm/dlist-const.inc'}

const
  DLIST : Array of Byte = [
    DL_BLANK8, DL_BLANK8, DL_BLANK8, DL_BLANK8, DL_BLANK4,// DL_BLANK8,

    DL_BLANK1 + DL_DLI, // DLI1
    DL_BLANK3,
// 48 lines in 160x96x2cols
    DL_MODE_160x96G2 + DL_LMS , lo(EDITOR_ADDR), hi(EDITOR_ADDR),
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2,
    DL_MODE_160x96G2, DL_MODE_160x96G2, DL_MODE_160x96G2, // + DL_DLI, // DLI2

    DL_BLANK2 + DL_DLI, // DLI3
// 25 lines in 160x96,4cols
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4,
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4,
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4,
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4,

    DL_BLANK4,
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4,

    DL_BLANK4 + DL_DLI, // DLI4
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4,
    DL_MODE_160x96G4, DL_MODE_160x96G4, DL_MODE_160x96G4 + DL_DLI, // DLI5

    DL_JVB, lo(word(@DLIST)), hi(word(@DLIST))
  ];

procedure myDLI(); assembler; interrupt;
Asm
COLPF0  = $D016  ; (708)
COLPF1  = $D017  ; (709)
COLPF2  = $D018  ; (710)
COLPF3  = $D019  ; (711)
COLPF4  = $D01A  ; (712)
WSYNC   = $D40A

  .macro m@setVDLI newVDLI
    lda #<:newVDLI
    sta DLIV
    lda #>:newVDLI
    sta DLIV+1
  .endm

dli1: // workarea
  pha
  lda #$E0
  sta wsync
  sta wsync
  sta COLPF4

  m@setVDLI DLI3

  pla
  rti

dli2: // timeline
  pha
  lda #$00
  sta wsync
  // sta wsync
  sta COLPF4

  m@setVDLI DLI3

  pla
  rti

dli3: // controls
  pha:txa:pha
  lda #$E6
  ldx #$E0
  sta wsync
  // sta wsync
  sta COLPF4
  stx COLPF1
  m@setVDLI DLI4

  pla:tax:pla
  rti

dli4: // status
  pha:txa:pha
  lda #$04
  ldx #$0f
  sta wsync
  sta COLPF4
  stx COLPF1
  m@setVDLI DLI5

  pla:tax:pla
  rti

dli5:
  pha
  lda 712
  sta wsync
  sta COLPF4

  m@setVDLI DLI1

  pla
  rti

End;
